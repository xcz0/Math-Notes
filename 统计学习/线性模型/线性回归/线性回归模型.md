# 线性回归模型

## 多元线性回归分析

### 模型介绍

变量关系包括：

+ 确定性关系：可以使用函数表达$Y=f(X,\epsilon)$，当$X$的维数过高，可能出现维度灾难
+ 非确定性关系

回归分析：研究变量之间相互关系。当给定$X$的取值时，$Y$的取值不能确定，只能通过一定的概率分布来描述。

（均值）回归函数：$$\mu(x) = E(Y|X = x)$$从平均意义下刻画了协变量$X$和响应变量$Y$之间的统计规律。

线性回归模型：
$$
 Y=X \beta + \epsilon
$$
其中：
$$
 Y=\begin{pmatrix} y_1 \\ y_2 \\ \vdots \\ y_n \end{pmatrix}
 X=\begin{pmatrix} 1 & x_{11} & \cdots x_{1p} \\  1 & x_{21} & \cdots x_{2p} \\ \vdots & \vdots & \vdots \\ 1 & x_{n1} & \cdots x_{np}  \\\end{pmatrix}
 \beta=\begin{pmatrix} \beta_1 \\ \beta_2 \\ \vdots \\ \beta_n \end{pmatrix}
 \epsilon=\begin{pmatrix} \epsilon_1 \\ \epsilon_2 \\ \vdots \\ \epsilon_n \end{pmatrix}
$$

Gauss-Markov 假设：

+ $E(\epsilon)=0$（若均值非 0，则应计入$\beta_0$中）
+ $\operatorname{Cov}(\epsilon)=\sigma^2 I_n$

$\epsilon$与$X$关系假设，从强到弱：

1. $\epsilon$与$X$独立
2. $E(\epsilon|x)=0$
3. $\epsilon$与$X$不相关

变形：

+ 指数模型：
+ 相乘模型
+ 多项式回归

特征工程：

+ 加平方项$X^{2}$，应避免使用高阶项，须不得已则须正则化
+ 加交互项$x_1x_2$
+ 分数次项$x^{\frac{1}{2}},x^{\frac{1}{3}}$
+ 对数项$\log X$
+ 三角函数项$\sin \pi X,\cos \pi X$
+ 其他经验关系

### 最小二乘估计

目的：使样本到线性回归函数的平均距离最小

距离取为几何距离时，得到最小二乘目标函数：
$$
Q(\beta)=\|Y-X \beta\|^{2} = (Y-X \beta)'(Y-X \beta)=YY'-2Y'X\beta+\beta'X'X\beta
$$

对$\beta$求偏导，并令其为零得$\beta=(X'X)^{-1}X'Y$，有解条件为$X'X$可逆

| |均值回归|中位回归|
|----|----|----|
|优化目标|$\mu =\min_{\mu}E(X-\mu)^{2}$|$\mu =\min_{\mu}E\left\vert X-\mu \right\vert$|
|残差假设|$\epsilon \sim  N(\delta^{2}I_n)$|$\epsilon \sim Laplace(\mu,\delta)$|
|缺点|受离群值影响大|计算困难|

最小二乘性质：

+ $E(\hat{\beta})=\beta$
+ $\operatorname{Cov}(\hat{\beta})=\sigma^{2}(X'X)^{-1}$

证明：

+ $E(\hat{\beta})=(X'X)^{-1}X'E(Y)=(X'X)^{-1}X'X\beta=\beta$
+ $$
\begin{aligned}
\operatorname{Cov}(\hat{\beta}) & = \operatorname{Cov}((X'X)^{-1}X'Y,(X'X)^{-1}X'Y)\\
& = (X'X)^{-1}X'\operatorname{Cov}(Y,Y)(X'X)^{-1}X' \\
& = (X'X)^{-1}X'\operatorname{Cov}(X \beta + \epsilon,X \beta + \epsilon)(X'X)^{-1}X' \\
& = (X'X)^{-1}X'\operatorname{Cov}(\epsilon,\epsilon)(X'X)^{-1}X' \\
& = \sigma^{2}I_n
\end{aligned}
$$

注意：$\operatorname{Cov}(X \beta + \epsilon,X \beta + \epsilon)=\operatorname{Cov}(\epsilon,\epsilon)$需满足前述$\epsilon$与$X$关系假设。

### $\sigma^{2}$的估计

残差向量：$\hat{\epsilon}=Y-X\hat{\beta}$

性质：$X'\hat{\beta}=0,Y'\hat{\beta}=0$

残差平方和 (residual sum of squares, RSS)：
$$RSS=\hat{\epsilon}'\hat{\epsilon}$$

$\hat{\sigma^{2}}$的无偏估计：
$$
\hat{\sigma^{2}}=\frac{RSS}{n-p-1}
$$

证明：
$$
\begin{aligned}
RSS & = \hat{\epsilon}'\hat{\epsilon}  \\
& = (Y-X\hat{\beta})'(Y-X\hat{\beta})\\
& = ((I_n-X(X'X)^{-1}X')Y)'((I_n-X(X'X)^{-1}X')Y)\\
& = Y'(I_n-X(X'X)^{-1}X')Y
\end{aligned}
$$
带入$E(Y)=X\beta,\operatorname{Cov}(Y)=\sigma^{2}I_n,E(X'AX)=\operatorname{tr}(A\Sigma)+\mu'A\mu$
$$
\begin{aligned}
E(RSS) & = E(Y'(I_n-X(X'X)^{-1}X')Y) \\
 & = \beta'X'(I_n-X(X'X)^{-1}X')X\beta + \sigma^{2}\operatorname{tr}(I_n-X(X'X)^{-1}X')\\
 &=\sigma^{2}[n-\operatorname{tr}(X(X'X)^{-1}X')]\\
 &=\sigma^{2}[n-\operatorname{tr}((X'X)^{-1}X'X)]\\
 &=\sigma^{2}[n-\operatorname{tr}(I_{p+1})]\\
 &=\sigma^{2}[n-p-1]\\
\end{aligned}
$$
