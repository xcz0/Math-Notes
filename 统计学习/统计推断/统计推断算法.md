# 统计推断算法

将模型中的所有未知量：预测结果、系统隐藏状态、模型参数，都作为随机变量处理。通过已知数据得出这些量的后验分布的过程称为**推断**(inference)。

一般用 $\theta$ 代表未知变量，用 $\mathcal{D}$ 代表已知变量。未知变量的后验分布为：
$$ p(\theta|\mathcal{D})=\frac{p(\theta)p(\mathcal{D}|\theta)}{p(\mathcal{D})} $$

归一化常数：
$$ p(\mathcal{D})=\int p(\mathcal{D}|\theta)p(\theta) \, d\theta  $$
是主要的计算难点，因为未知参数的维度可能很高。

常用的计算方式有：
#TODO 


当获得后验分布后，即可计算感兴趣的后验期望

其中函数 $g$ 的选取包括：
+ 均值：
+ 方差：
+ 边际分布：
+ 预测：
+ 期望损失：模型先验概率

## 推断模式

### 全局隐变量

未知变量对所有训练数据皆有影响，但独立于其他变量，例如模型参数，其联合分布为：
$$ p(Y,\theta|X)=p(Y|X,\theta)p(\theta|X)=p(\theta)\prod_{i=1}^{N}p(y_i|x_{i},\theta) $$
推断目标为 $p(\theta|X,Y)$
### 局部隐变量

未知变量只对部分已知变量产生影响，例如模型的隐藏状态，影响其他输出，但对参数无影响，其联合分布为：

推断目标为 $p(z|x,\theta)$
