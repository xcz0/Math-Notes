# 部分回归

为考察去除部分特征后，回归模型的变化，将协变量矩阵与回归系数拆为两部分：
$$ X = \begin{pmatrix}
X_1 & X_2
\end{pmatrix},\quad \beta = \begin{bmatrix}
\beta_1 \\
\beta_2
\end{bmatrix} $$
其中 $X_1 \in R^{n \times k},X_2\in R^{n \times l},\beta_1 \in R^{k},\beta_2 \in R^{l}$。此时回归模型的拟合结果为：
$$ Y = X_1\hat{\beta_1}+ X_2\hat{\beta_2}+\hat{\varepsilon} $$
称为长回归(long regressin)。
若仅使用 $X_2$ 拟合：
$$ Y=X_2\tilde{\beta_2}+\tilde{\varepsilon} $$
则称为短回归(short regression)。

## Frisch–Waugh–Lovell (FWL) Theorem

长回归系数为：
$$\begin{pmatrix} \hat{\beta}_1\\\hat{\beta}_2 \end{pmatrix}=(X^\mathrm{T}X)^{-1}X^\mathrm{T}Y=\begin{pmatrix}
S_{11}&S_{12}\\S_{21}&S_{22}
\end{pmatrix} \begin{pmatrix}
X_1^\mathrm{T}Y\\X_2^\mathrm{T}Y
\end{pmatrix}$$
其中 $S_{ij}$ 为 $(X^\mathrm{T}X)^{-1}$