# 普通最小二乘法（优化视角）

使用 $X\beta$ 拟合 $Y$，其中协变量矩阵 $X$ 已知，$\beta$ 为使两者度量最小的最优解：
$$\hat{\beta}=\arg\min_b\|Y-Xb\|^2$$

目标函数是 $b$ 的二次函数，是[[凸优化]]问题，故最优点满足一阶条件：
$$-2\sum_{i=1}^nx_i(y_i-x_i^\mathrm{T}\hat{\beta})=0$$
可简化为：
$$\sum_{i=1}^nx_i(y_i-x_i^\mathrm{T}\hat{\beta})=0\Longleftrightarrow X^\mathrm{T}(Y-X\hat{\beta})=0.$$
>[!theorem] 普通最小二乘系数
若 $X^\mathsf{T}X$ *可逆*，则解为：
$$ \hat{\beta}=(X^\mathsf{T}X)^{-1}X^\mathsf{T}Y $$

## 解的存在条件

由于 $X^\mathsf{T}X\alpha=0$ 与 $X\alpha=0$ 同解，故两者的秩相同。若 $X^\mathsf{T}X$ 可逆，则其秩等于 $X$ 的列向量数，即 $X$ *列向量线性独立*。（ $X$ 的列向量数必须小于其行向量数。
）

## 几何解释

由于 $Xb$ 是 $X$ 列向量的线性组合，且对 $b$ 没有限制，故问题可视为在 $X$ 的列向量空间 $\mathcal{C}(X)$ 中找出与 $Y$ 最接近的向量，即 $Y$ 在 $\mathcal{C}(X)$ 上的[[投影]]。

由此可知其残差 $Y-X\hat{\beta}$ 应正交与空间 $\mathcal{C}(X)$ ，即
$$ X^\mathsf{T}(Y-X \hat{\beta})=0 $$
