# 线性正态系统

若随机变量服从正态分布，而另一随机变量依赖于其的条件分布也为正态分布，且均值为其仿射变换，则称这组变量为线性正态系统：
$$\begin{aligned}
\mathbf{X} & \sim \mathcal{N}(\boldsymbol{x}|\boldsymbol{\mu}_x,\boldsymbol{\Sigma}_x)\\
\mathbf{Y|X} & \sim \mathcal{N}(\boldsymbol{y}|\boldsymbol{Wx}+\boldsymbol{b},\boldsymbol{\Sigma}_y)\end{aligned}$$

## 联合分布

两者的联合密度为 $p(\boldsymbol x,\boldsymbol y)=p(\boldsymbol x)p(\boldsymbol y|\boldsymbol x)$，只考虑其指数项：
$$ -\frac12(\boldsymbol{x}-\boldsymbol{\mu}_x)^T\boldsymbol{\Sigma}_x^{-1}(\boldsymbol{x}-\boldsymbol{\mu}_x)-\frac12(\boldsymbol{y}-\mathbf{W}\boldsymbol{x}-\boldsymbol{b})^T\boldsymbol{\Sigma}_y^{-1}(\boldsymbol{y}-\mathbf{W}\boldsymbol{x}-\boldsymbol{b}) $$
忽略常数项与一次项，只考虑二次项：
$$\begin{aligned}
Q &=-\frac12\boldsymbol{x}^T\boldsymbol{\Sigma}_x^{-1}\boldsymbol{x}-\frac12\boldsymbol{y}^T\boldsymbol{\Sigma}_y^{-1}\boldsymbol{y}-\frac12(\mathbf{W}\boldsymbol{x})^T\boldsymbol{\Sigma}_y^{-1}(\mathbf{W}\boldsymbol{x})+\boldsymbol{y}^T\boldsymbol{\Sigma}_y^{-1}\mathbf{W}\boldsymbol{x} \\
&=-\frac12\begin{pmatrix}\boldsymbol{x}\\\boldsymbol{y}\end{pmatrix}^T\begin{pmatrix}\boldsymbol{\Sigma}_x^{-1}+\mathbf{W}^T\boldsymbol{\Sigma}_y^{-1}\mathbf{W}&-\mathbf{W}^T\boldsymbol{\Sigma}_y^{-1}\\-\boldsymbol{\Sigma}_y^{-1}\mathbf{W}&\boldsymbol{\Sigma}_y^{-1}\end{pmatrix}\begin{pmatrix}\boldsymbol{x}\\ \boldsymbol{y}\end{pmatrix} \\
\end{aligned}$$
所以联合分布的协方差矩阵的逆为：
$$\mathbf{\Sigma}^{-1}=\begin{pmatrix}\mathbf{\Sigma}_x^{-1}+\mathbf{W}^T\mathbf{\Sigma}_y^{-1}\mathbf{W}&-\mathbf{W}^T\mathbf{\Sigma}_y^{-1}\\-\mathbf{\Sigma}_y^{-1}\mathbf{W}&\mathbf{\Sigma}_y^{-1}\end{pmatrix}\triangleq\mathbf{\Lambda}=\begin{pmatrix}\mathbf{\Lambda}_{xx}&\mathbf{\Lambda}_{xy}\\\mathbf{\Lambda}_{yx}&\mathbf{\Lambda}_{yy}\end{pmatrix}$$
通过[[分块矩阵的逆]]计算得：
$$\boldsymbol{\Sigma}=\begin{pmatrix}\boldsymbol{\Sigma}_x&\boldsymbol{\Sigma}_x\mathbf{W}^\intercal\\\mathbf{W}\boldsymbol{\Sigma}_x&\boldsymbol{\Sigma}_y+\mathbf{W}\boldsymbol{\Sigma}_x\mathbf{W}^\intercal\end{pmatrix}$$

## 后验分布


