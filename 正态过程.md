# 正态过程

对于目标函数f，不考虑其表达式，不关注其在整个定义域上的取值，只考虑其在有限个点上的取值 $\mathbf{f}=[f_X, f_{*}]=[f(x_1),\cdots,f(x_N),f(x_{*1}),\cdots,f(x_{*M})]$。

## 无噪声观测

假设 $\mathbf{f}$ 服从正态分布：
$$\begin{bmatrix}\boldsymbol{f}_X\\\boldsymbol{f}_*\end{bmatrix}\sim\mathcal{N}\left(\begin{bmatrix}\boldsymbol{\mu}_X\\\boldsymbol{\mu}_*\end{bmatrix},\begin{bmatrix}\mathbf{K}_{X,X}&\mathbf{K}_{X,*}\\\mathbf{K}_{X,*}^\mathsf{T}&\mathbf{K}_{*,*}\end{bmatrix}\right)$$
其中 $\mathbf{K}_{X,X},$ 皆为[[正定核]]。

根据[[正态分布的条件分布]]可得：
$$\begin{align}
p(\boldsymbol{f}_{*}|\mathbf{X}_{*},\mathcal{D})& =\mathcal{N}(\boldsymbol{f}_*|\boldsymbol{\mu}_*,\boldsymbol{\Sigma}_*) \\
\mu_{*}& =m(\mathbf{X}_*)+\mathbf{K}_{X,*}^\mathsf{T}\mathbf{K}_{X,X}^{-1}(\boldsymbol{f}_X-m(\mathbf{X})) \\
\Sigma_{*}& =\mathrm{K}_{*,*}-\mathrm{K}_{X,*}^{\mathsf{T}}\mathrm{K}_{X,X}^{-1}\mathrm{K}_{X,*} 
\end{align}$$
## 存在噪声观测

若观测结果带有噪声，即：$y_n=f(x_n)+\epsilon_{n}$，其中噪声与观测值无关且独立服从正态分布 $\epsilon_{n} \sim \mathcal{N}(0,\sigma^2_{y})$。
故观测值之间的相关为：
$$\mathrm{Cov}\left[y_i,y_j\right]=\mathrm{Cov}\left[f_i,f_j\right]+\mathrm{Cov}\left[\epsilon_i,\epsilon_j\right]=\mathcal{K}(\boldsymbol{x}_i,\boldsymbol{x}_j)+\sigma_y^2\delta_{ij}$$
其中 $\delta_{ij}=\mathbb{I}\left(i=j\right)$。即
$$\mathrm{Cov}\left[\boldsymbol{y}|\mathbf{X}\right]=\mathbf{K}_{X,X}+\sigma_y^2\mathbf{I}_N\triangleq\mathbf{K}_\sigma $$
而观测值与待预测函数值之间的相关为：
$$\mathrm{Cov}\left[\boldsymbol{y},f_{*}\right]=\mathrm{Cov}\left[\boldsymbol{f}_{X},f_{*}\right]=\mathbf{K}_{X,*}$$
故模型为：
$$\begin{bmatrix}\boldsymbol{y}\\\boldsymbol{f}_*\end{bmatrix}\sim\mathcal{N}\left(\begin{bmatrix}\boldsymbol{\mu}_X\\\boldsymbol{\mu}_*\end{bmatrix},\begin{bmatrix}\mathbf{K}_\sigma&\mathbf{K}_{X,*}\\\mathbf{K}_{X,*}^\mathsf{T}&\mathbf{K}_{*,*}\end{bmatrix}\right)$$
其后验分布为：
$$\begin{aligned}
p(\boldsymbol{f}_{*}|\mathcal{D},\mathbf{X}_{*})& =\mathcal{N}(f_*|\boldsymbol{\mu}_{*|X},\boldsymbol{\Sigma}_{*|X}) \\
\mu_{*|X}& =\mu_*+\mathrm{K}_{X,*}^\mathsf{T}\mathbf{K}_\sigma^{-1}(\boldsymbol{y}-\boldsymbol{\mu}_X) \\
\Sigma_{*|X}& =\mathbf{K}_{*,*}-\mathbf{K}_{X,*}^{\mathsf{T}}\mathbf{K}_{\sigma}^{-1}\mathbf{K}_{X,*} 
\end{aligned}$$

