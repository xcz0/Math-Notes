# 有向图中的条件无关性

若在图 $G$ 中，在给定事件 $C$ 的条件下，$A$ 与 $B$ 条件无关，则记为 $x_{A} \perp_{G} x_{B} |x_{C}$。将由图 $G$ 给出的所有条件无关关系记为 $I(G)$；在分布 $p$ 下存在的条件无关关系记为 $I(p)$。若在分布 $p$ 下，图 $G$ 给出的所有条件无关关系仍然成立，即 $I(G) \subseteq I(p)$，则称图 $G$ 是关于分布 $p$ 的**独立映射**(independence map, I-map)，或称分布 $p$ 关于图 $G$ 是无记忆性的。全连接图（非有向图）是独立映射，因为图中不存在条件无关关系。若图 $G$ 是分布 $p$ 的独立映射，但不存在子图满足这一性质的子图，则称图 $G$ 是分布 $p$ 的**最小独立映射**(minimal I-map)。 

## 全局Markov性

若*无向路径*$P$ 包含以下三种结构，则称其关于节点集 $C$ 是 d-分离的：
+ 链式结构(Chain):  $s \rightarrow m \rightarrow t,\ m \in C$
	+ 如果给定中间节点 $m$ 的值，那么 $s$ 和 $t$ 是条件独立的：
	+ $$ p(s,t|m)=\frac{p(s,m,t)}{p(m)}=\frac{p(s,m)P(t|s,m)}{p(m)}=p(s|m)p(t|m) $$
	+ 例如，天气影响道路湿滑状况，湿滑的道路影响事故发生率。给定湿滑状况的信息后，天气和事故之间变得条件独立。
+ 分支结构 (Fork): $s \leftarrow m \rightarrow t,\ m \in C$
	+ 如果给定父节点 $m$ 的值，那么 $s$ 和 $t$ 是条件独立的：
	+ $$ p(s,t|m)=\frac{p(s,m,t)}{p(m)}=\frac{p(s,m)P(t|s,m)}{p(m)}=p(s|m)p(t|m) $$
	+ 例如，一个疾病可以导致咳嗽和发烧。如果知道疾病的情况，那么咳嗽和发烧是条件独立的。
+ 合取结构 (Collider): $s\rightarrow  m \leftarrow t,\ m \notin C$ 并且$m$无后继
	+ 在这个结构中，只有在没有观察到节点 $m$ 的情况下，$s,t$ 是独立的。如果给定 $m$ 或其任何后继节点的值，$s,t$ 会变得依赖：
	+ $$  p(s,t|m)=\frac{p(s,m,t)}{p(m)}=\frac{p(s,t)p(m|s,t)}{p(m)}=\frac{p(s)p(t)p(m|s,t)}{p(m)}=p(s|m)p(t|m)\frac{p(m|s,t)p(m)}{p(m|s)p(m|t)}  $$
	+ 例如，假设小偷进入了房子或强风可能导致警报响起。如果知道警报响起，那么小偷进入和强风事件之间可能存在关联。

若节点集 $A$ 中的每一个节点到节点集 $B$ 中的每一个节点的*任意*路径关于节点集 $C$ 是 d-分离的，则称节点集 $A$ 与节点集 $B$ 关于节点集 $C$ 是 d-分离的。并且定义为有向图中的条件无关性。也称之为（有向）全局Markov性。

## Bayes球算法

用于判断两个节点是否条件无关。从一个节点出发，通过一定规则，若可到达另一节点，则两节点条件相关，若不能，则条件无关。
在链式结构与分支结构中，若中间节点为条件，则不能通过
在合取结构中，若若中间节点为条件，则可以通过。
![[Bayes球.png]]

![[Bayes球的边界条件.png]]

## Markov筐

将节点的子节点、父节点、共父节点（其子节点的另一个父节点）称为**Markov筐**(Markov blanket)。






